{"data":{"site":{"siteMetadata":{"siteUrl":"http://ghost.local:8000","title":"Ghost Docs","description":"Everything you need to know about working with the Ghost professional publishing platform."}},"ghostPost":{"title":"Can I run Ghost(Pro) from a subdirectory","slug":"can-i-run-ghost-from-a-subdirectory","featured":false,"feature_image":null,"created_at_pretty":"27 September, 2018","published_at_pretty":"27 September, 2018","updated_at_pretty":"28 March, 2019","created_at":"2018-09-27T23:05:28.000+00:00","published_at":"2018-09-27T23:07:00.000+00:00","updated_at":"2019-03-28T10:12:42.000+00:00","excerpt":"Using subdirectories with Ghost(Pro) is supported at Business plan level. Find out how to set up a subdirectory.","meta_title":"Can I run Ghost(Pro) from a subdirectory? - FAQ","meta_description":"Using subdirectories with Ghost(Pro) is supported at Business plan level. Find out how to set up a subdirectory using this tutorial.","og_description":null,"og_image":null,"og_title":null,"twitter_description":null,"twitter_image":null,"twitter_title":null,"authors":[{"name":"Sarah Frantz","slug":"sarah","bio":null,"profile_image":"//www.gravatar.com/avatar/930a564053be3c38824dfee3e89d2074?s=250&d=mm&r=x","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Sarah Frantz","slug":"sarah","bio":null,"profile_image":"//www.gravatar.com/avatar/930a564053be3c38824dfee3e89d2074?s=250&d=mm&r=x","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"Ghost(Pro)","slug":"ghost-pro","description":"Commonly asked questions and support for Ghost(Pro) customers!","feature_image":null,"meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","visibility":"public"},"tags":[{"name":"Ghost(Pro)","slug":"ghost-pro","description":"Commonly asked questions and support for Ghost(Pro) customers!","feature_image":null,"meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","visibility":"public"},{"name":"#faq","slug":"hash-faq","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"internal"}],"plaintext":"If you have an existing site — for example a shop, or a static site hosted\nelsewhere — Ghost can be run from a separate location e.g. yourdomain.com/blog \notherwise known as a subdirectory.\n\nSubdirectory installs are supported at the Business plan level\n[https://ghost.org/pricing/]  and require a custom nginx or apache configuration\nthat follows reverse proxy rules. In addition to a proxy, you must also contact \nsupport@ghost.org  to indicate the subdirectory path to be used with your\npublication.\n\nReverse proxy rules\nFollow these rules to create a valid reverse proxy to Ghost(Pro). You can use\nthe same setup to proxy if you don't need a subdirectory as well. \n\n1. Provide a certificate & serve HTTPS traffic.\nOnly HTTPS traffic is supported.\n\n2. Redirect non-HTTPS traffic to HTTPS.\nIt's more performant for this to be configured at the proxy level.\n\n3. Proxy to your ghost.io subdomain, leaving it set as the HOST header.\nRequired to get through our security layer.\n\n4. Have an X-Forwarded-Host header that matches the custom domain in\nmy.ghost.org.\nWithout this, your blog will redirect to your ghost.io subdomain, causing a\nloop.\n\n5. Include the X-Forwarded-Proto header set to https not http.\nWithout this your blog will redirect to https, causing a loop.\n\n6. Include the X-Forwarded-For header, populated with the remote IP of the\noriginal request.\nWithout this, we aren't able to detect spam traffic patterns and your site risks\nbeing rate limited or incorrectly restricted.\n\n7. Pass through all requests with the correct methods and headers\nYour proxy must forward all HEAD, GET, POST, PUT and DELETE requests to your\nhost with the request method, headers, and response intact, and must also pass\nthrough all standard HTTP headers and any x-ghost  headers, including\nAuthorization and set-cookie.\n\nExample configurations\nThe following configurations show how to setup a reverse proxy for a\nsubdirectory. \n\n * Nginx [https://docs.ghost.org/faq/nginx-subdirectory-setup/]\n * Apache [https://docs.ghost.org/faq/apache-subdirectory-setup/]\n * CloudFront [https://docs.ghost.org/faq/cloudfront-subdirectory-setup/]\n\nTroubleshooting\nThese configurations are only guaranteed  to work in isolation. If you have any\npre-existing top-level domain config, this could override the subdirectory. To\ntroubleshoot any issues, review your top-level domain config for conflicts.\n\nVerification\nTo ensure your proxy is sending the correct headers use the following curl\ncommand:\n\n  curl -IL -H 'x-ghost-proxy:true' https://<your domain here>/<subdirectory>  \n\nIf your proxy is correct you’ll see a response header of x-ghost-proxy set to\nVALID. If an invalid header is detected, you will see INVALID next to it.  This\ncommand only verifies headers and does not check that all traffic is being\nrouted correctly.\n\nOnce your proxy is configured, we recommend verifying the following things, to\nensure the proxy is working fully:\n\n * Login to https://<your domain here>/<subdirectory>/ghost/\n * Upload an image\n * Create and schedule a post \n * Delete a post\n * See changes reflected in the sitemap at https://<your domain\n   here>/<subdirectory>/sitemap.xml","html":"<p>If you have an existing site — for example a shop, or a static site hosted elsewhere — Ghost can be run from a separate location e.g. <code>yourdomain.com/blog</code> otherwise known as a subdirectory.</p><p>Subdirectory installs are supported at the <a href=\"https://ghost.org/pricing/\" rel=\"noreferrer nofollow noopener\">Business plan level</a> and require a custom nginx or apache configuration that follows reverse proxy rules. In addition to a proxy, you must also contact <a href=\"mailto:support@ghost.org\" rel=\"noreferrer nofollow noopener\">support@ghost.org</a> to indicate the subdirectory path to be used with your publication.</p><h2 id=\"reverse-proxy-rules\">Reverse proxy rules</h2><p>Follow these rules to create a valid reverse proxy to Ghost(Pro). You can use the same setup to proxy if you don't need a subdirectory as well. </p><p><strong>1. Provide a certificate &amp; serve HTTPS traffic.</strong><br>Only HTTPS traffic is supported.</p><p><strong>2. Redirect non-HTTPS traffic to HTTPS.</strong><br>It's more performant for this to be configured at the proxy level.</p><p><strong>3. Proxy to your ghost.io subdomain, leaving it set as the HOST header.</strong><br>Required to get through our security layer.</p><p><strong>4. Have an X-Forwarded-Host header that matches the custom domain in my.ghost.org.</strong><br>Without this, your blog will redirect to your ghost.io subdomain, causing a loop.</p><p><strong>5. Include the X-Forwarded-Proto header set to https not http.</strong><br>Without this your blog will redirect to https, causing a loop.</p><p><strong>6. Include the X-Forwarded-For header, populated with the remote IP of the original request.</strong><br>Without this, we aren't able to detect spam traffic patterns and your site risks being rate limited or incorrectly restricted.</p><p><strong>7. Pass through all requests with the correct methods and headers</strong><br>Your proxy must forward all HEAD, GET, POST, PUT and DELETE requests to your host with the request method, headers, and response intact, and must also pass through all standard HTTP headers and any <code>x-ghost</code> headers, including Authorization and set-cookie.</p><h2 id=\"example-configurations\">Example configurations</h2><p>The following configurations show how to setup a reverse proxy for a subdirectory. </p><ul><li><a href=\"https://docs.ghost.org/faq/nginx-subdirectory-setup/\">Nginx</a></li><li><a href=\"https://docs.ghost.org/faq/apache-subdirectory-setup/\">Apache</a></li><li><a href=\"https://docs.ghost.org/faq/cloudfront-subdirectory-setup/\">CloudFront</a></li></ul><h2 id=\"troubleshooting\">Troubleshooting</h2><p>These configurations are only <em>guaranteed</em> to work in isolation. If you have any pre-existing top-level domain config, this could override the subdirectory. To troubleshoot any issues, review your top-level domain config for conflicts.</p><h2 id=\"verification\">Verification</h2><p>To ensure your proxy is sending the correct headers use the following curl command:</p><p> <code>curl -IL -H 'x-ghost-proxy:true' https://&lt;your domain here&gt;/&lt;subdirectory&gt;</code> </p><p>If your proxy is correct you’ll see a response header of x-ghost-proxy set to VALID. If an invalid header is detected, you will see INVALID next to it.  This command only verifies headers and does not check that all traffic is being routed correctly.</p><p>Once your proxy is configured, we recommend verifying the following things, to ensure the proxy is working fully:</p><ul><li>Login to <code>https://&lt;your domain here&gt;/&lt;subdirectory&gt;/ghost/</code></li><li>Upload an image</li><li>Create and schedule a post </li><li>Delete a post</li><li>See changes reflected in the sitemap at <code>https://&lt;your domain here&gt;/&lt;subdirectory&gt;/sitemap.xml</code></li></ul>","custom_template":null,"url":"https://docs.ghost.io/can-i-run-ghost-from-a-subdirectory/","uuid":"ab57bf82-de3d-49c3-b98f-f31df65f0699","page":false,"codeinjection_foot":null,"codeinjection_head":null,"comment_id":"5bad6238f193d500bfd5b42a"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"can-i-run-ghost-from-a-subdirectory","relatedPosts":[{"node":{"slug":"migrating-from-wordpress-to-ghost","title":"Migrating from WordPress to Ghost","url":"/faq/migrating-from-wordpress-to-ghost/","published_at":"2019-04-22T15:50:47.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"general","name":"General","description":null,"meta_title":null,"meta_description":null,"feature_image":null},{"slug":"self-hosting","name":"Self-hosting","description":"Commonly asked questions, upgrade information and guides for developers who are self-hosting an instance of Ghost!","meta_title":"Self Hosting FAQs","meta_description":"Commonly asked questions, upgrade information and guides for developers who are self-hosting an instance of Ghost!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"nginx-subdirectory-setup","title":"Nginx Subdirectory Setup","url":"/faq/nginx-subdirectory-setup/","published_at":"2019-03-28T08:58:07.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"apache-subdirectory-setup","title":"Apache Subdirectory Setup","url":"/faq/apache-subdirectory-setup/","published_at":"2019-03-28T08:57:25.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"cloudfront-subdirectory-setup","title":"CloudFront Subdirectory Setup","url":"/faq/cloudfront-subdirectory-setup/","published_at":"2019-03-22T13:33:13.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"hover-domain-setup-guide","title":"Hover domain setup guide","url":"/faq/hover-domain-setup-guide/","published_at":"2018-10-10T14:24:48.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}}],"section":"faq"}}