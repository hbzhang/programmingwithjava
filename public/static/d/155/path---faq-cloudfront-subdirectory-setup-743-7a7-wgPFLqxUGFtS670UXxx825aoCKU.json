{"data":{"site":{"siteMetadata":{"siteUrl":"http://ghost.local:8000","title":"Ghost Docs","description":"Everything you need to know about working with the Ghost professional publishing platform."}},"ghostPost":{"title":"CloudFront Subdirectory Setup","slug":"cloudfront-subdirectory-setup","featured":false,"feature_image":null,"created_at_pretty":"22 March, 2019","published_at_pretty":"22 March, 2019","updated_at_pretty":"20 May, 2019","created_at":"2019-03-22T13:15:59.000+00:00","published_at":"2019-03-22T13:33:13.000+00:00","updated_at":"2019-05-20T15:05:20.000+00:00","excerpt":"It's possible to use an AWS CloudFront Distribution to setup a subdirectory with\nGhost(Pro). For this configuration to work successfully, you must be on a\nBusiness plan with a subdirectory enabled via support@ghost.org  and follow the\nconfiguration steps below.\n\n> Use of CloudFront for a subdirectory setup is considered highly advanced and may\nrequire additional technical knowledge and troubleshooting\n[https://docs.ghost.org/faq/can-i-run-ghost-from-a-subdirectory/]. The below\nconfiguration has ","meta_title":"CloudFront Subdirectory Setup with Ghost(Pro) – FAQ","meta_description":"It's possible to use an AWS CloudFront Distribution to setup a subdirectory with Ghost(Pro). Find out more about how to get this configuration to work.","og_description":null,"og_image":null,"og_title":null,"twitter_description":null,"twitter_image":null,"twitter_title":null,"authors":[{"name":"Sarah Frantz","slug":"sarah","bio":null,"profile_image":"//www.gravatar.com/avatar/930a564053be3c38824dfee3e89d2074?s=250&d=mm&r=x","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Sarah Frantz","slug":"sarah","bio":null,"profile_image":"//www.gravatar.com/avatar/930a564053be3c38824dfee3e89d2074?s=250&d=mm&r=x","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"Ghost(Pro)","slug":"ghost-pro","description":"Commonly asked questions and support for Ghost(Pro) customers!","feature_image":null,"meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","visibility":"public"},"tags":[{"name":"Ghost(Pro)","slug":"ghost-pro","description":"Commonly asked questions and support for Ghost(Pro) customers!","feature_image":null,"meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","visibility":"public"},{"name":"#faq","slug":"hash-faq","description":null,"feature_image":null,"meta_description":null,"meta_title":null,"visibility":"internal"}],"plaintext":"It's possible to use an AWS CloudFront Distribution to setup a subdirectory with\nGhost(Pro). For this configuration to work successfully, you must be on a\nBusiness plan with a subdirectory enabled via support@ghost.org  and follow the\nconfiguration steps below.\n\n> Use of CloudFront for a subdirectory setup is considered highly advanced and may\nrequire additional technical knowledge and troubleshooting\n[https://docs.ghost.org/faq/can-i-run-ghost-from-a-subdirectory/]. The below\nconfiguration has been tested and works with these exact settings if there are\nno conflicting top-level config issues.\nDistribution Settings\n * Alternate Domain Names  must match the custom domain you want to use\n * The SSL Certificate  must match the desired custom domain (either exact or\n   wildcard).\n\nOrigins & Origin Groups Settings\n * Origin Domain Name  must match the ghost.io URL\n * X-Forwarded-Host  must be set to the desired custom domain\n * X-Forwarded-Proto  must be set to https\n\nBehaviour Settings\nThe default behaviour settings for your distribution can be used, however you\nwill need to setup a second behaviour with the following settings:\n\n * The Path Pattern  field needs to be set with the desired subdirectory, e.g. \n   blog/*\n * The Viewer Protocol Policy  must be set to Redirect HTTP to HTTPS\n * The Origin  and Referer  headers must be whitelisted\n\nRoute 53 Settings / DNS\nIf you are using Route 53 with your domain to manage DNS records, an alias\nrecord must be set with a target of the CloudFront Distribution.\n\nIf you are using a non-Route 54 DNS provider, you will need to create an alias\nrecord that points to your CloudFront Distribution address.","html":"<p>It's possible to use an AWS CloudFront Distribution to setup a subdirectory with Ghost(Pro). For this configuration to work successfully, you must be on a Business plan with a subdirectory enabled via <a href=\"mailto:support@ghost.org\">support@ghost.org</a> and follow the configuration steps below.</p><blockquote>Use of CloudFront for a subdirectory setup is considered highly advanced and may require additional technical knowledge and <a href=\"https://docs.ghost.org/faq/can-i-run-ghost-from-a-subdirectory/\">troubleshooting</a>. The below configuration has been tested and works with these exact settings if there are no conflicting top-level config issues.</blockquote><h2 id=\"distribution-settings\">Distribution Settings</h2><!--kg-card-begin: image--><figure class=\"kg-card kg-image-card\"><img src=\"https://docs.ghost.io/content/images/2019/03/aws-cf-distribution-settings-1.png\" class=\"kg-image\"></figure><!--kg-card-end: image--><ul><li><strong>Alternate Domain Names</strong> must match the custom domain you want to use</li><li>The <strong>SSL Certificate</strong> must match the desired custom domain (either exact or wildcard).</li></ul><h2 id=\"origins-origin-groups-settings\">Origins &amp; Origin Groups Settings</h2><!--kg-card-begin: image--><figure class=\"kg-card kg-image-card\"><img src=\"https://docs.ghost.io/content/images/2019/03/aws-cf-origin-and-origin-group-settings-1.png\" class=\"kg-image\"></figure><!--kg-card-end: image--><ul><li><strong>Origin Domain Name</strong> must match the ghost.io URL</li><li><strong>X-Forwarded-Host</strong> must be set to the desired custom domain</li><li><strong>X-Forwarded-Proto</strong> must be set to https</li></ul><h2 id=\"behaviour-settings\">Behaviour Settings</h2><p>The default behaviour settings for your distribution can be used, however you will need to setup a second behaviour with the following settings:</p><!--kg-card-begin: image--><figure class=\"kg-card kg-image-card\"><img src=\"https://docs.ghost.io/content/images/2019/03/aws-cf-behaviour-settings-v2.png\" class=\"kg-image\"></figure><!--kg-card-end: image--><ul><li>The <strong>Path Pattern</strong> field needs to be set with the desired subdirectory, e.g. <code>blog/*</code></li><li>The <strong>Viewer Protocol Policy</strong> must be set to Redirect HTTP to HTTPS</li><li>The <strong>Origin</strong> and <strong>Referer</strong> headers must be whitelisted</li></ul><h2 id=\"route-53-settings-dns\">Route 53 Settings / DNS</h2><p>If you are using Route 53 with your domain to manage DNS records, an alias record must be set with a target of the CloudFront Distribution.</p><!--kg-card-begin: image--><figure class=\"kg-card kg-image-card\"><img src=\"https://docs.ghost.io/content/images/2019/03/aws-cf-route-53-1.png\" class=\"kg-image\"></figure><!--kg-card-end: image--><p>If you are using a non-Route 54 DNS provider, you will need to create an alias record that points to your CloudFront Distribution address.</p>","custom_template":null,"url":"https://docs.ghost.io/cloudfront-subdirectory-setup/","uuid":"2834c738-079f-47de-9ba7-361a9dccfdfc","page":false,"codeinjection_foot":null,"codeinjection_head":null,"comment_id":"5c94e00fcb358d00c095d3aa"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"cloudfront-subdirectory-setup","relatedPosts":[{"node":{"slug":"migrating-from-wordpress-to-ghost","title":"Migrating from WordPress to Ghost","url":"/faq/migrating-from-wordpress-to-ghost/","published_at":"2019-04-22T15:50:47.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"general","name":"General","description":null,"meta_title":null,"meta_description":null,"feature_image":null},{"slug":"self-hosting","name":"Self-hosting","description":"Commonly asked questions, upgrade information and guides for developers who are self-hosting an instance of Ghost!","meta_title":"Self Hosting FAQs","meta_description":"Commonly asked questions, upgrade information and guides for developers who are self-hosting an instance of Ghost!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"nginx-subdirectory-setup","title":"Nginx Subdirectory Setup","url":"/faq/nginx-subdirectory-setup/","published_at":"2019-03-28T08:58:07.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"apache-subdirectory-setup","title":"Apache Subdirectory Setup","url":"/faq/apache-subdirectory-setup/","published_at":"2019-03-28T08:57:25.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"hover-domain-setup-guide","title":"Hover domain setup guide","url":"/faq/hover-domain-setup-guide/","published_at":"2018-10-10T14:24:48.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}},{"node":{"slug":"google-domain-setup-guide","title":"Google domain setup guide","url":"/faq/google-domain-setup-guide/","published_at":"2018-10-08T21:55:14.000+00:00","feature_image":null,"tags":[{"slug":"ghost-pro","name":"Ghost(Pro)","description":"Commonly asked questions and support for Ghost(Pro) customers!","meta_title":"Ghost(Pro) FAQs – Find answers & support for your site","meta_description":"If you get stuck, browse our commonly asked questions, or contact email support for Ghost(Pro) premium hosted customers!","feature_image":null},{"slug":"hash-faq","name":"#faq","description":null,"meta_title":null,"meta_description":null,"feature_image":null}]}}],"section":"faq"}}